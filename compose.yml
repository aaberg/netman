include:
  - compose.backend.yml

services:

  web:
    build:
      context: ./netman-web
      dockerfile: Dockerfile
    restart: unless-stopped
    environment:
      NETMAN_API_URL: http://api:8080
      PUBLIC_HANKO_API_URL: http://localhost:8000
      SERVER_HANKO_API_URL: http://hanko:8000
      NODE_ENV: production
      PORT: 3000
      HOST: 0.0.0.0
      ORIGIN: http://localhost
      # OpenTelemetry - disabled by default, set to true and provide connection string to enable
      OTEL_EXPORTER_AZUREMONITOR_ENABLED: ${OTEL_EXPORTER_AZUREMONITOR_ENABLED:-false}
      OTEL_EXPORTER_AZUREMONITOR_CONNECTION_STRING: ${OTEL_EXPORTER_AZUREMONITOR_CONNECTION_STRING:-}
      OTEL_SERVICE_NAME: ${OTEL_SERVICE_NAME:-netman-web}
      OTEL_SAMPLING_RATIO: ${OTEL_SAMPLING_RATIO:-0.1}
    networks:
      - default
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.web.rule=Host(`localhost`)"
      - "traefik.http.routers.web.entrypoints=webEntry"
      - "traefik.http.services.web.loadbalancer.server.port=3000"